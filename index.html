<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake News Detection - AI-Powered News Verification</title>
    
    <!-- Bootstrap CSS with dark theme -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="text-center py-5">
            <div class="mb-4">
                <i class="fas fa-newspaper display-1 text-primary"></i>
            </div>
            <h1 class="display-4 fw-bold mb-3">Fake News Detection</h1>
            <p class="lead mb-4">AI-powered tool to verify news authenticity using machine learning</p>
            <div class="text-muted">
                <small><i class="fas fa-robot me-2"></i>Powered by PassiveAggressiveClassifier & TF-IDF</small>
            </div>
        </header>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="row justify-content-center mb-4">
                    <div class="col-lg-8">
                        {% for category, message in messages %}
                            <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                                <i class="fas fa-{{ 'exclamation-triangle' if category == 'warning' else 'info-circle' if category == 'info' else 'check-circle' if category == 'success' else 'times-circle' }} me-2"></i>
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
        {% endwith %}

        <!-- Main Content -->
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Input Form -->
                <div class="card shadow-lg mb-4">
                    <div class="card-header">
                        <h3 class="card-title mb-0">
                            <i class="fas fa-search me-2"></i>News Analysis
                        </h3>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="{{ url_for('predict') }}" id="newsForm">
                            <div class="mb-3">
                                <label for="news_text" class="form-label fw-semibold">
                                    Enter news headline or article text:
                                </label>
                                <textarea 
                                    class="form-control" 
                                    id="news_text" 
                                    name="news_text" 
                                    rows="6" 
                                    placeholder="Paste your news article or headline here to check if it's real or fake..."
                                    required
                                    maxlength="10000">{{ input_text if input_text else '' }}</textarea>
                                <div class="form-text">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Enter at least 10 characters. Maximum 10,000 characters allowed.
                                    </small>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg" id="analyzeBtn">
                                    <i class="fas fa-brain me-2"></i>
                                    <span class="btn-text">Analyze News</span>
                                    <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Results -->
                {% if result %}
                <div class="card shadow-lg result-card">
                    <div class="card-body text-center">
                        <div class="mb-4">
                            <div class="result-icon mb-3">
                                {% if result.is_real %}
                                    <i class="fas fa-check-circle text-success display-3"></i>
                                {% else %}
                                    <i class="fas fa-times-circle text-danger display-3"></i>
                                {% endif %}
                            </div>
                            
                            <h2 class="result-label fw-bold mb-3 text-{{ result.class }}">
                                {{ result.label }}
                            </h2>
                            
                            <div class="confidence-score mb-4">
                                <p class="mb-2 text-muted">Confidence Score</p>
                                <div class="progress mb-2" style="height: 20px;">
                                    <div class="progress-bar bg-{{ result.class }}" 
                                         role="progressbar" 
                                         style="width: {{ result.confidence }}%"
                                         aria-valuenow="{{ result.confidence }}" 
                                         aria-valuemin="0" 
                                         aria-valuemax="100">
                                        <span class="fw-semibold">{{ "%.1f"|format(result.confidence) }}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Analysis Details -->
                        <div class="analysis-details">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <i class="fas fa-{{ 'shield-alt text-success' if result.is_real else 'exclamation-triangle text-warning' }} me-2"></i>
                                        <span class="fw-semibold">Classification:</span>
                                        <span class="ms-1">{{ 'Authentic News' if result.is_real else 'Potentially Fake' }}</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <i class="fas fa-chart-line me-2 text-info"></i>
                                        <span class="fw-semibold">Reliability:</span>
                                        <span class="ms-1">
                                            {% if result.confidence >= 80 %}High
                                            {% elif result.confidence >= 60 %}Medium
                                            {% else %}Low
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Disclaimer -->
                        <div class="alert alert-info mt-4 mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            <small>
                                <strong>Disclaimer:</strong> This tool provides automated analysis based on machine learning patterns. 
                                Always cross-reference with multiple reliable sources for important news verification.
                            </small>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- How it Works Section -->
                <div class="card mt-5 mb-4">
                    <div class="card-header">
                        <h4 class="card-title mb-0">
                            <i class="fas fa-cogs me-2"></i>How It Works
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <div class="text-center">
                                    <i class="fas fa-text-width text-primary fs-2 mb-3"></i>
                                    <h6 class="fw-semibold">Text Processing</h6>
                                    <p class="text-muted small">Advanced NLP preprocessing including tokenization, stop word removal, and text normalization.</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="text-center">
                                    <i class="fas fa-vector-square text-primary fs-2 mb-3"></i>
                                    <h6 class="fw-semibold">Feature Extraction</h6>
                                    <p class="text-muted small">TF-IDF vectorization to convert text into numerical features for machine learning analysis.</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="text-center">
                                    <i class="fas fa-brain text-primary fs-2 mb-3"></i>
                                    <h6 class="fw-semibold">ML Classification</h6>
                                    <p class="text-muted small">PassiveAggressiveClassifier trained on real news datasets to distinguish authentic from fake news.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center py-4 mt-5">
            <div class="text-muted">
                <p class="mb-2">
                    <i class="fas fa-code me-2"></i>Built with Flask, scikit-learn, and Bootstrap
                </p>
                <small>
                    <i class="fas fa-exclamation-triangle me-1"></i>
                    For educational and demonstration purposes. Always verify news through multiple trusted sources.
                </small>
            </div>
        </footer>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('newsForm');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const btnText = analyzeBtn.querySelector('.btn-text');
            const spinner = analyzeBtn.querySelector('.spinner-border');
            const textarea = document.getElementById('news_text');
            
            // Form submission handling
            form.addEventListener('submit', function(e) {
                const text = textarea.value.trim();
                
                if (text.length < 10) {
                    e.preventDefault();
                    alert('Please enter at least 10 characters of text to analyze.');
                    textarea.focus();
                    return;
                }
                
                // Show loading state
                analyzeBtn.disabled = true;
                btnText.textContent = 'Analyzing...';
                spinner.classList.remove('d-none');
            });
            
            // Character counter
            textarea.addEventListener('input', function() {
                const maxLength = 10000;
                const currentLength = this.value.length;
                const remaining = maxLength - currentLength;
                
                // Update form text
                const formText = this.parentNode.querySelector('.form-text small');
                if (remaining < 100) {
                    formText.innerHTML = `<i class="fas fa-exclamation-triangle me-1 text-warning"></i>Characters remaining: ${remaining}`;
                } else {
                    formText.innerHTML = `<i class="fas fa-info-circle me-1"></i>Enter at least 10 characters. Maximum 10,000 characters allowed.`;
                }
            });
            
            // Auto-resize textarea
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 300) + 'px';
            });
            
            // Focus on textarea when page loads
            textarea.focus();
        });
        
        // Fade in animation for results
        const resultCard = document.querySelector('.result-card');
        if (resultCard) {
            resultCard.style.opacity = '0';
            resultCard.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                resultCard.style.transition = 'all 0.5s ease-in-out';
                resultCard.style.opacity = '1';
                resultCard.style.transform = 'translateY(0)';
            }, 100);
        }
    </script>
</body>
</html>
